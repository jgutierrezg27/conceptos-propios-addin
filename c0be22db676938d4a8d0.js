/*! For license information please see c0be22db676938d4a8d0.js.LICENSE.txt */
function _regenerator(){var e,r,o="function"==typeof Symbol?Symbol:{},t=o.iterator||"@@iterator",n=o.toStringTag||"@@toStringTag";function a(o,t,n,a){var l=t&&t.prototype instanceof c?t:c,u=Object.create(l.prototype);return _regeneratorDefine2(u,"_invoke",function(o,t,n){var a,c,l,u=0,s=n||[],f=!1,y={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(r,o){return a=r,c=0,l=e,y.n=o,i}};function d(o,t){for(c=o,l=t,r=0;!f&&u&&!n&&r<s.length;r++){var n,a=s[r],d=y.p,p=a[2];o>3?(n=p===t)&&(l=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((n=o<2&&d<a[1])?(c=0,y.v=t,y.n=a[1]):d<p&&(n=o<3||a[0]>t||t>p)&&(a[4]=o,a[5]=t,y.n=p,c=0))}if(n||o>1)return i;throw f=!0,t}return function(n,s,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),c=s,l=p;(r=c<2?e:l)||!f;){a||(c?c<3?(c>1&&(y.n=-1),d(c,l)):y.n=l:y.v=l);try{if(u=2,a){if(c||(n="next"),r=a[n]){if(!(r=r.call(a,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(l=TypeError("The iterator does not provide a '"+n+"' method"),c=1);a=e}else if((r=(f=y.n<0)?l:o.call(t,y))!==i)break}catch(r){a=e,c=1,l=r}finally{u=1}}return{value:r,done:f}}}(o,n,a),!0),u}var i={};function c(){}function l(){}function u(){}r=Object.getPrototypeOf;var s=[][t]?r(r([][t]())):(_regeneratorDefine2(r={},t,function(){return this}),r),f=u.prototype=c.prototype=Object.create(s);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_regeneratorDefine2(e,n,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=u,_regeneratorDefine2(f,"constructor",u),_regeneratorDefine2(u,"constructor",l),l.displayName="GeneratorFunction",_regeneratorDefine2(u,n,"GeneratorFunction"),_regeneratorDefine2(f),_regeneratorDefine2(f,n,"Generator"),_regeneratorDefine2(f,t,function(){return this}),_regeneratorDefine2(f,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:y}})()}function _regeneratorDefine2(e,r,o,t){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}_regeneratorDefine2=function(e,r,o,t){function a(r,o){_regeneratorDefine2(e,r,function(e){return this._invoke(r,o,e)})}r?n?n(e,r,{value:o,enumerable:!t,configurable:!t,writable:!t}):e[r]=o:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(e,r,o,t)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,r){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){o&&(e=o);var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(c)throw a}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var o=0,t=Array(r);o<r;o++)t[o]=e[o];return t}function asyncGeneratorStep(e,r,o,t,n,a,i){try{var c=e[a](i),l=c.value}catch(e){return void o(e)}c.done?r(l):Promise.resolve(l).then(t,n)}function _asyncToGenerator(e){return function(){var r=this,o=arguments;return new Promise(function(t,n){var a=e.apply(r,o);function i(e){asyncGeneratorStep(a,t,n,i,c,"next",e)}function c(e){asyncGeneratorStep(a,t,n,i,c,"throw",e)}i(void 0)})}}import{dictionary}from"./dictionary";function normalizarTextoOutlook(){return _normalizarTextoOutlook.apply(this,arguments)}function _normalizarTextoOutlook(){return _normalizarTextoOutlook=_asyncToGenerator(_regenerator().m(function e(){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:try{console.log("ðŸ”„ Iniciando normalizaciÃ³n en Outlook..."),mostrarEstado("Procesando...","info"),(r=Office.context.mailbox.item).itemType===Office.MailboxEnums.ItemType.Message?r.body.getAsync(Office.CoercionType.Html,function(){var e=_asyncToGenerator(_regenerator().m(function e(o){var t,n,a,i,c,l,u,s,f,y,d,p,m,g,b,_;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(o.status===Office.AsyncResultStatus.Succeeded){t=o.value,console.log("ðŸ“§ Contenido original obtenido"),n=0,a=_createForOfIteratorHelper(dictionary);try{for(a.s();!(i=a.n()).done;){c=i.value,l=_toConsumableArray(c.matches).sort(function(e,r){return r.length-e.length}),u="",s=_createForOfIteratorHelper(c.replacement);try{for(s.s();!(f=s.n()).done;)(y=f.value).bold?u+="<strong>".concat(y.text,"</strong>"):u+=y.text}catch(e){s.e(e)}finally{s.f()}console.log("ðŸ” Buscando: ".concat(l.join(", "))),console.log("   Reemplazar con: ".concat(u)),d=_createForOfIteratorHelper(l);try{for(d.s();!(p=d.n()).done;)m=p.value,g=m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),b=new RegExp(g,"gi"),(_=t.match(b))&&(console.log("  âœ¨ Encontradas ".concat(_.length,' coincidencia(s) de "').concat(m,'"')),t=t.replace(b,u),n+=_.length)}catch(e){d.e(e)}finally{d.f()}}}catch(e){a.e(e)}finally{a.f()}r.body.setAsync(t,{coercionType:Office.CoercionType.Html},function(e){e.status===Office.AsyncResultStatus.Failed?(console.error("âŒ Error al actualizar el cuerpo del correo:",e.error.message),mostrarEstado("Error al actualizar el correo","error")):n>0?(console.log("âœ… Texto normalizado exitosamente. ".concat(n," cambio(s) realizado(s).")),mostrarEstado("âœ… ".concat(n," cambio(s) realizado(s)"),"success")):(console.log("â„¹ï¸ No se encontraron coincidencias para reemplazar."),mostrarEstado("No se encontraron textos que coincidan con el diccionario","info"))})}else console.error("âŒ Error al obtener el cuerpo del correo:",o.error.message),mostrarEstado("Error al obtener el contenido del correo","error");case 1:return e.a(2)}},e)}));return function(r){return e.apply(this,arguments)}}()):(console.log("âš ï¸ Correo en modo de lectura"),mostrarEstado("Para normalizar texto, abre un correo nuevo o responde/reenvÃ­a","info"))}catch(e){console.error("âŒ Error en Outlook:",e),mostrarEstado("Error: "+e.message,"error")}case 1:return e.a(2)}},e)})),_normalizarTextoOutlook.apply(this,arguments)}Office.onReady(function(e){console.log("Office estÃ¡ listo. Host: ".concat(e.host,", Plataforma: ").concat(e.platform));var r=document.getElementById("btn-normalizar"),o=document.getElementById("status");r&&r.addEventListener("click",normalizarTextoOutlook),window.mostrarEstado=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";o.textContent=e,o.className="status ".concat(r),o.style.display="block","success"===r&&setTimeout(function(){o.style.display="none"},5e3)}});